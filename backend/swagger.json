{
  "openapi": "3.0.3",
  "info": {
    "title": "GoGoMarket API",
    "description": "API для социального видеомаркетплейса GoGoMarket.uz",
    "version": "1.0.0",
    "contact": {
      "name": "GoGoMarket Support",
      "url": "https://gogomarket.uz"
    }
  },
  "servers": [
    {
      "url": "http://64.226.94.133/api/v1",
      "description": "Production server"
    },
    {
      "url": "http://localhost:3000/api/v1",
      "description": "Development server"
    }
  ],
  "tags": [
    { "name": "Auth", "description": "Аутентификация и авторизация" },
    { "name": "Products", "description": "Управление товарами" },
    { "name": "Videos", "description": "Видео контент" },
    { "name": "Orders", "description": "Заказы" },
    { "name": "Cart", "description": "Корзина" },
    { "name": "Chat", "description": "Чат между пользователями" },
    { "name": "Stories", "description": "Истории продавцов" },
    { "name": "Seller", "description": "Функции продавца" },
    { "name": "Courier", "description": "Функции курьера" },
    { "name": "Admin", "description": "Административные функции" }
  ],
  "paths": {
    "/auth/register": {
      "post": {
        "tags": ["Auth"],
        "summary": "Регистрация пользователя",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["phone", "password"],
                "properties": {
                  "phone": { "type": "string", "example": "+998901234567" },
                  "password": { "type": "string", "example": "MyPassword123!" },
                  "role": { "type": "string", "enum": ["buyer", "seller", "courier"], "default": "buyer" },
                  "acceptedTerms": { "type": "boolean", "example": true },
                  "acceptedPrivacy": { "type": "boolean", "example": true }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Успешная регистрация",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "tags": ["Auth"],
        "summary": "Вход в систему",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["phone", "password"],
                "properties": {
                  "phone": { "type": "string", "example": "+998911111111" },
                  "password": { "type": "string", "example": "Test123!" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Успешный вход",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/auth/profile": {
      "get": {
        "tags": ["Auth"],
        "summary": "Получить профиль пользователя",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Профиль пользователя",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          }
        }
      }
    },
    "/products": {
      "get": {
        "tags": ["Products"],
        "summary": "Список товаров",
        "parameters": [
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 20 } },
          { "name": "category", "in": "query", "schema": { "type": "string" } },
          { "name": "sellerId", "in": "query", "schema": { "type": "string", "format": "uuid" } }
        ],
        "responses": {
          "200": {
            "description": "Список товаров",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Products"],
        "summary": "Создать товар (только для продавцов)",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateProduct"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Товар создан"
          }
        }
      }
    },
    "/videos/feed": {
      "get": {
        "tags": ["Videos"],
        "summary": "Лента видео",
        "parameters": [
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } }
        ],
        "responses": {
          "200": {
            "description": "Список видео"
          }
        }
      }
    },
    "/cart": {
      "get": {
        "tags": ["Cart"],
        "summary": "Получить корзину",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Корзина пользователя"
          }
        }
      }
    },
    "/cart/items": {
      "post": {
        "tags": ["Cart"],
        "summary": "Добавить товар в корзину",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["productId"],
                "properties": {
                  "productId": { "type": "string", "format": "uuid" },
                  "variantId": { "type": "string", "format": "uuid" },
                  "quantity": { "type": "integer", "default": 1 }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Товар добавлен в корзину"
          }
        }
      }
    },
    "/orders": {
      "get": {
        "tags": ["Orders"],
        "summary": "Список заказов пользователя",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Список заказов"
          }
        }
      },
      "post": {
        "tags": ["Orders"],
        "summary": "Создать заказ",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrder"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Заказ создан"
          }
        }
      }
    },
    "/orders/available": {
      "get": {
        "tags": ["Courier"],
        "summary": "Доступные заказы для курьера",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Список доступных заказов"
          }
        }
      }
    },
    "/chats": {
      "post": {
        "tags": ["Chat"],
        "summary": "Создать чат",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["userId"],
                "properties": {
                  "userId": { "type": "string", "format": "uuid" }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Чат создан"
          }
        }
      }
    },
    "/stories": {
      "get": {
        "tags": ["Stories"],
        "summary": "Список историй",
        "responses": {
          "200": {
            "description": "Список историй продавцов"
          }
        }
      }
    },
    "/seller/reports": {
      "get": {
        "tags": ["Seller"],
        "summary": "Отчеты продавца",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "period", "in": "query", "schema": { "type": "string", "enum": ["day", "week", "month"] } }
        ],
        "responses": {
          "200": {
            "description": "Отчет продавца"
          }
        }
      }
    },
    "/admin/stats": {
      "get": {
        "tags": ["Admin"],
        "summary": "Статистика платформы",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Статистика"
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health check",
        "responses": {
          "200": {
            "description": "API работает",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean", "example": true },
                    "message": { "type": "string", "example": "GoGoMarket API is running" }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "AuthResponse": {
        "type": "object",
        "properties": {
          "success": { "type": "boolean" },
          "data": {
            "type": "object",
            "properties": {
              "token": { "type": "string" },
              "user": { "$ref": "#/components/schemas/User" }
            }
          }
        }
      },
      "UserResponse": {
        "type": "object",
        "properties": {
          "success": { "type": "boolean" },
          "data": { "$ref": "#/components/schemas/User" }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "phone": { "type": "string" },
          "firstName": { "type": "string" },
          "lastName": { "type": "string" },
          "role": { "type": "string", "enum": ["buyer", "seller", "courier", "admin"] }
        }
      },
      "ProductsResponse": {
        "type": "object",
        "properties": {
          "success": { "type": "boolean" },
          "data": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/Product" }
          },
          "pagination": { "$ref": "#/components/schemas/Pagination" }
        }
      },
      "Product": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "title": { "type": "string" },
          "description": { "type": "string" },
          "price": { "type": "number" },
          "stock": { "type": "integer" },
          "images": { "type": "array", "items": { "type": "string" } }
        }
      },
      "CreateProduct": {
        "type": "object",
        "required": ["title", "price"],
        "properties": {
          "title": { "type": "string" },
          "description": { "type": "string" },
          "price": { "type": "number" },
          "originalPrice": { "type": "number" },
          "stock": { "type": "integer", "default": 0 },
          "category": { "type": "string" },
          "images": { "type": "array", "items": { "type": "string" } }
        }
      },
      "CreateOrder": {
        "type": "object",
        "required": ["productId", "quantity", "shippingAddress", "shippingCity", "shippingPhone"],
        "properties": {
          "productId": { "type": "string", "format": "uuid" },
          "quantity": { "type": "integer" },
          "paymentMethod": { "type": "string", "enum": ["cash", "card"], "default": "cash" },
          "shippingAddress": { "type": "string" },
          "shippingCity": { "type": "string" },
          "shippingPhone": { "type": "string" },
          "buyerNote": { "type": "string" }
        }
      },
      "Pagination": {
        "type": "object",
        "properties": {
          "page": { "type": "integer" },
          "limit": { "type": "integer" },
          "total": { "type": "integer" },
          "totalPages": { "type": "integer" }
        }
      }
    }
  }
}
